<!-- Authors: Anjali Karki, Indira Ruslanova, Flora Mukako, Ali Bichanga -->
{% extends "base.html" %}

{% block main_content %}
<h1>Roomie-match</h1>
<form method="post" action="{{url_for('viewPosts')}}"> 
    <p style="text-align: center;"> <label for="filter"> Filter by housing needs: </label>
        <select id="filter" name="filter">
            <option value = "">select</option>
            <option value = "both">both</option>
            {% for option in options %}
                <option value="{{option.housing_option}}"> {{option.housing_option}}</option>
            {% endfor %}
        </select>
        <input type="submit" value="filter">
    </p>
</form>
{% for post in allPosts %}

<div class="post" >
    
        <p> {{post.name}} is looking for {{post.post_type}}! </p>
        <p class="desc">Post Description: {{post.post_desc or "No description"}}. </p>
        <ul>
            <li>Location: {{post.location}}</li>
            <li>Monthly Rent: ${{post.budget}}</li>
            <li>Maximum Number of Roommates Needed: {{post.max_roommates}}</li>
            <li>Shared Bathroom: {{post.shared_bathroom}}</li>
            <li>Shared Bedroom: {{post.shared_bedroom}}</li>
            <li>Pets Friendly: {{post.ok_with_pets}}</li>
            <li>Picture of the room:</li> 
            <img class="pics" src="{{url_for('roompic',file_id=post.file_id)}}" alt="">
        </ul>
        <p style="font-size: x-small;"> Posted <i>{{post.time_diff}} day(s) ago</i> </p>

        {% if post.user_id != current_user_id %}
        <form method="get" action="{{url_for('sendMessage',rec_id=post.user_id)}}">
        <p><input type="submit" id="submit" value="Message {{post.name}}"> </p>
        <p><input type="hidden" name="recipient" id="submit" value="Message {{post.user_id}}"> </p>
        </form>
        {% endif %}

        {% if post.user_id == current_user_id %}
        <form action="{{url_for('delete_post',post_id=post.post_id)}}" method="POST" onsubmit="return confirm('Are you sure you want to delete this post?');">
            <button type="submit" class="btn btn-danger">Delete</button>
        </form>
        {% endif %}

        {% if post.user_id == current_user_id %}
        <form action="{{url_for('updatePost',post_id=post.post_id)}}" method="GET">
            <button type="submit" class="btn btn-danger">Edit</button>
        </form>
        {% endif %}
</div>
{% endfor %}
{% endblock %}